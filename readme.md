updated code prompted by microsoft copilot
